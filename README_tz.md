# Library Management API

Этот проект представляет собой RESTful API для управления книгами в библиотеке с использованием Go, PostgreSQL и пакета `expvar` для сбора метрик.

## Оглавление

- [Функционал](#функционал)
- [Требования](#требования)
- [Установка](#установка)
- [Использование](#использование)
- [API Эндпоинты](#api-эндпоинты)
- [Метрики](#метрики)
- [Миграции базы данных](#миграции-базы-данных)
- [Лицензия](#лицензия)

## Функционал

- Управление книгами с помощью CRUD операций (создание, чтение, обновление, удаление).
- Интеграция с базой данных PostgreSQL.
- Сбор и публикация метрик с использованием пакета `expvar`.

## Требования

- [Go 1.16+](https://golang.org/dl/)
- [PostgreSQL](https://www.postgresql.org/download/)
- [Git](https://git-scm.com/)

## Установка

1. Склонируйте репозиторий:

    ```bash
    git clone https://github.com/username/library-management-api.git
    cd library-management-api
    ```

2. Настройте PostgreSQL:

    - Создайте базу данных и пользователя PostgreSQL.
    - Настройте переменные окружения:

    ```bash
    export DB_HOST=localhost
    export DB_PORT=5432
    export DB_USER=yourusername
    export DB_PASSWORD=yourpassword
    export DB_NAME=yourdatabasename
    ```

3. Установите зависимости и запустите миграции:

    ```bash
    go mod tidy
    go run main.go migrate
    ```

4. Запустите приложение:

    ```bash
    go run main.go
    ```

## Использование

После запуска приложение будет доступно по адресу `http://localhost:8080`.

### API Эндпоинты

- **`GET /books`**: Возвращает список всех книг.
- **`POST /books`**: Добавляет новую книгу.
- **`GET /books/{id}`**: Возвращает книгу по идентификатору.
- **`PUT /books/{id}`**: Обновляет информацию о книге по идентификатору.
- **`DELETE /books/{id}`**: Удаляет книгу по идентификатору.

### Метрики

Пакет `expvar` используется для сбора и отображения метрик приложения. Метрики доступны по адресу `http://localhost:8080/debug/vars`.

Доступные метрики:
- **`request_count`**: Общее количество запросов.
- **`success_count`**: Количество успешных ответов.
- **`error_count`**: Количество ошибок.
- Дополнительные метрики для базы данных могут быть добавлены по мере необходимости.

## Миграции базы данных

Для управления миграциями базы данных используется встроенный инструмент:

- Запуск миграций:

    ```bash
    go run main.go migrate
    ```

## Лицензия

Этот проект распространяется под лицензией MIT. Подробнее см. файл [LICENSE](LICENSE).
